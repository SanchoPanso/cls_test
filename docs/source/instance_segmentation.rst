Сегментация
============

В этом разделе описывается процесс подготовки и обучения модели YOLOv8 для задачи инстансной сегментации. Он включает в себя описание двух основных шагов:

* Создание датасета в формате YOLO
* Обучение модели YOLOv8 на задачу сегментации

Создание датасета в формате YOLO
--------------------------------

Назначение:

Скрипт create_yolo_dataset.py предназначен для конвертации датасетов, аннотированных в формате COCO, 
в формат, совместимый с моделью YOLO. 
Это первый шаг в подготовке данных для обучения.

Подготовка исходных данных:
^^^^^^^^^^^^^^^^^^^^^^^^^^^

Перед использованием скрипта, убедитесь, что исходные датасеты размещены в папке segmentation_data/source_datasets. 
В этой папке должна быть следующая структура:

.. code-block:: bash
    
    - segmentation_data/source_datasets/
        - dataset1/
            - images/
            - annotations/
                - instances_default.json
        - dataset2/
            - images/
            - annotations/
                - instances_default.json
        -...


Описание работы скрипта:

Скрипт анализирует исходные аннотации COCO, извлекает информацию о положении объектов (bounding boxes)
 и их классификации, после чего преобразует её в нужный формат.

Использование:

.. code-block:: bash

    python create_yolo_dataset.py --src_dir <path_to_coco_annotations> --dst_dir <path_to_yolo_dataset>

Параметры командной строки:

    --input: путь к файлу с исходными аннотациями COCO.
    --output: директория для сохранения датасета в формате YOLO.

Обучение модели YOLOv8 на задачу сегментации
-------------------------------------------

Назначение:

Скрипт train_yolo_seg.py используется для обучения модели YOLOv8, используя подготовленный на предыдущем шаге датасет. 
Этот процесс является вторым и заключительным шагом в подготовке модели к работе по задаче инстансной сегментации.

Описание работы скрипта:

Скрипт инициирует обучение модели с возможностью настройки различных параметров, 
таких как количество эпох, размер батча и скорость обучения.

Использование:

.. code-block:: bash

    python train_yolo_seg.py --data <path_to_yolo_dataset> --epochs <num_epochs> --batch-size <batch_size>

Параметры командной строки:

    --data: путь к подготовленному датасету в формате YOLO.
    --epochs: количество эпох для обучения.
    --batch-size: размер батча.

.. note::

    Проверьте совместимость настроек обучения с вашей аппаратной конфигурацией, 
    особенно при использовании GPU, чтобы избежать проблем с переполнением памяти.

    